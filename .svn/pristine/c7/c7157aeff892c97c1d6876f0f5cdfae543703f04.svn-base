(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ec264c4"],{"056e":function(e,t,a){"use strict";var l=a("f8f1"),n=a.n(l);n.a},"3aa2":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"RetailShare"},[a("el-card",{staticClass:"crad",attrs:{shadow:"hover"}},[a("search-sale",{attrs:{title:e.table.title,loading:e.loading},on:{getAnalysis:e.getAnalysis,handleDownload:e.handleDownload,exportPdf:e.exportPdf}})],1),e._v(" "),e.page?a("el-card",{attrs:{"body-style":{padding:"0px 0px 50px 0px"}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.table.tableData,"row-style":e.rowStyle,"header-cell-style":{padding:"0px 0px"}}},[a("el-table-column",{attrs:{label:e.table.title,align:"center"}},[a("el-table-column",{attrs:{prop:"area",label:"区域",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customer",label:"所属经销商",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:e.table.year+e.table.season,align:"center"}},[a("el-table-column",{attrs:{prop:"newSalesShare",label:"销售占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newAvgPrice",label:"均单价",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newInventoryRatio",label:"库存占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newStoreVolume",label:"单店铺货量",align:"center"}})],1)],1),e._v(" "),a("el-table-column",{attrs:{label:e.date,align:"center"}},[a("el-table-column",{attrs:{label:e.table.year-1+e.table.season,align:"center"}},[a("el-table-column",{attrs:{prop:"oldSalesShare",label:"销售占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldAvgPrice",label:"单价",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldInventoryRatio",label:"库存占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldStoreVolume",label:"单店铺货量",align:"center"}})],1)],1)],1)],1):e._e(),e._v(" "),e.page?a("el-card",{attrs:{"body-style":{padding:"0px 0px 50px 0px",marginTop:"10px 0px 0px 0px"}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:e.lastTable.tableData,"row-style":e.rowStyle,"header-cell-style":{padding:"0px 0px"}}},[a("el-table-column",{attrs:{label:e.lastTable.title,align:"center"}},[a("el-table-column",{attrs:{prop:"area",label:"区域",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customer",label:"所属经销商",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:e.lastTable.year+e.lastTable.season,align:"center"}},[a("el-table-column",{attrs:{prop:"newSalesShare",label:"销售占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newAvgPrice",label:"均单价",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newInventoryRatio",label:"库存占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newStoreVolume",label:"单店铺货量",align:"center"}})],1)],1),e._v(" "),a("el-table-column",{attrs:{label:e.date,align:"center"}},[a("el-table-column",{attrs:{label:e.lastTable.year-1+e.lastTable.season,align:"center"}},[a("el-table-column",{attrs:{prop:"oldSalesShare",label:"销售占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldAvgPrice",label:"单价",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldInventoryRatio",label:"库存占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldStoreVolume",label:"单店铺货量",align:"center"}})],1)],1)],1)],1):e._e()],1)},n=[],i=(a("96cf"),a("3b8d")),r=a("ab95"),o=a("ad8f"),s=a("ed08"),c=a("6f9c"),d={name:"RetailShare",components:{searchSale:r["a"]},data:function(){return{loading:!1,date:"",page:!1,total:0,table:{title:"零售占比",year:0,tableData:[]},lastTable:{title:"零售占比",year:"",tableData:[]}}},methods:{getAnalysis:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,this.date="查询时间："+t.billdate,this.table.year=t.year=this.$moment(t.billdate).year(),this.table.season=Object(c["b"])(t.billdate).ch,this.table.title=""+t.year+Object(c["b"])(t.billdate).ch+"数量占比",t.season=Object(c["b"])(t.billdate).zh,e.next=8,Object(o["c"])(t).then((function(e){l.$store.dispatch("table/setRetailShare",e),l.table.tableData=e}));case 8:return this.lastTable.title=""+this.$moment(t.billdate).add(-3,"M").year()+Object(c["b"])(this.$moment(t.billdate).add(-3,"M")).ch+"数量占比",a={billdate:t.billdate,year:this.$moment(t.billdate).add(-3,"M").year(),season:Object(c["b"])(this.$moment(t.billdate).add(-3,"M")).zh},this.lastTable.year=a.year,this.lastTable.season=Object(c["b"])(this.$moment(t.billdate).add(-3,"M")).ch,this.lastTable.title=""+a.yaer+Object(c["b"])(this.$moment(t.billdate).add(-3,"M")).ch+"数量占比",e.next=15,Object(o["c"])(a).then((function(e){l.$store.dispatch("table/setLastRetailShare",e),l.lastTable.tableData=e,l.page=!0,l.loading=!1}));case 15:this.$message({message:"查询完成!!!",type:"success"});case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),exportPdf:function(){this.getPdf(this.table.title)},handleDownload:function(e){var t=this;this.loading=!0,0!==this.table.tableData.length?(e=void 0===e?"":e,Promise.all([a.e("chunk-014a57fc"),a.e("chunk-581b2547")]).then(a.bind(null,"4bf8d")).then((function(a){var l=["日均销额排名","经销商","当日店均销额","当日店均销量","当日店均单价","20年当月累计单店","19年当月累计单店","增长","20年日均","19年日均","日均增长","20年当日店均","19年当日店均","日均增长"],n=["dayTop","customer","dayAvgSale","dayAvgSum","dayAvgPrice","monStoreSum1","monStoreSum2","increase","oldYearDayAvg1","olgYearDayAvg2","oldDayAvgIncrease1","oldDayAvg1","oldDayAvg2","oldDayAvgIncrease2"],i=t.formatJson(n,e);a.export_json_to_excel({header:l,data:i,filename:t.table.title}),t.loading=!1}))):this.loading=!1},formatJson:function(e,t){var a=[];if("all"===t)a=this.$store.getters.retailShare;else{if("this"!==t)return;a=this.table.tableData}return a.map((function(t){return e.map((function(e){return"timestamp"===e?Object(s["b"])(t[e]):t[e]}))}))},rowStyle:function(e){var t=e.row;e.rowIndex;return"区域汇总"===t.customer?"background: #DDE6ED":""}}},u=d,p=(a("bcfe"),a("2877")),b=Object(p["a"])(u,l,n,!1,null,"fce2d69c",null);t["default"]=b.exports},5336:function(e,t,a){"use strict";var l=a("93dd"),n=a.n(l);n.a},6724:function(e,t,a){"use strict";a("8d41");var l="@@wavesContext";function n(e,t){function a(a){var l=Object.assign({},t.value),n=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},l),i=n.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var r=i.getBoundingClientRect(),o=i.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(r.width,r.height)+"px",i.appendChild(o)),n.type){case"center":o.style.top=r.height/2-o.offsetHeight/2+"px",o.style.left=r.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(a.pageY-r.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(a.pageX-r.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=n.color,o.className="waves-ripple z-active",!1}}return e[l]?e[l].removeHandle=a:e[l]={removeHandle:a},a}var i={bind:function(e,t){e.addEventListener("click",n(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[l].removeHandle,!1),e.addEventListener("click",n(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[l].removeHandle,!1),e[l]=null,delete e[l]}},r=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(r)),i.install=r;t["a"]=i},"6cec":function(e,t,a){},"6f9c":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var l=a("c1df");function n(e,t){e=void 0===e?0:e,t=void 0===t?"":t;var a=new Date;a.setDate(a.getDate()+e);var l=a.getFullYear(),n=a.getMonth()+1,i=a.getDate();return n=n>9?n:"0"+n,i=i>9?i:"0"+i,""===t?""+l+n+i:"Y"===t?""+l:"M"===t?""+n:"D"===t?""+i:"YM"===t?""+l+n:"MD"===t?""+n+i:"YMD"===t?""+l+n+i:""}function i(e){var t=void 0===e?l().month()+1:l(e).month()+1,a={};switch(t){case 1:case 2:case 3:a={ch:"春季",zh:"37"};break;case 4:case 5:case 6:a={ch:"夏季",zh:"38"};break;case 7:case 8:case 9:a={ch:"秋季",zh:"39"};break;case 10:case 11:case 12:a={ch:"冬季",zh:"40"};break;default:a="";break}return a}},"8d41":function(e,t,a){},"93dd":function(e,t,a){},ab95:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"seach-length"},[a("el-row",{attrs:{gutter:10}},[a("el-col",[a("el-date-picker",{staticStyle:{"min-width":"300px","margin-bottom":"5px","font-size":"12px"},attrs:{type:"date","value-format":"yyyyMMdd",placeholder:"开始日期","picker-options":e.pickerOptions,format:"yyyyMMdd"},model:{value:e.listQuery.billdate,callback:function(t){e.$set(e.listQuery,"billdate",t)},expression:"listQuery.billdate"}}),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search",loading:e.loading,disabled:e.loading},on:{click:e.handleFilter}},[e._v("查询")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload("this")}}},[e._v("单页导出")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:e.exportPdf}},[e._v("PDF")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload("all")}}},[e._v("全部导出")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-message",circle:""},on:{click:e.tipsInfo}})],1)],1),e._v(" "),a("prompt-box",{attrs:{"dialog-visible":e.dialogVisible,title:e.title,"tips-data":e.tipsData},on:{handleClose:e.handleClose}})],1)},n=[],i=a("6724"),r=a("6f9c"),o=a("e251"),s={name:"SearchSale",directives:{waves:i["a"]},components:{promptBox:o["a"]},props:{loading:{type:Boolean,default:!1},title:{type:String,default:""}},data:function(){return{showAllLevels:!1,listQuery:{billdate:Object(r["a"])(-1)},storeOptions:[],restaurants:[],dialogVisible:!1,options:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()-864e5}},tips:{top30:[{name:"店铺名称",description:"有零售数据的店铺"},{name:"日业绩",description:"查询日期的零售金额"},{name:"日销量",description:"查询日期的零售数量"},{name:"日单价",description:"日业绩/日销量,取整"},{name:"本月业绩",description:"查询日期月份的总零售金额"},{name:"本月销量",description:"查询日期月份的总零售数量"},{name:"本月日均销额",description:"本月业绩/本月销量"},{name:"季度库存",description:"查询当日前一天的款号库存，该季度库存与查询日有关，与查询日期无关"}],storeDayAvg:[{name:"经销商",description:"按客户区分"},{name:"当日店均销额",description:"查询日期所有门店零售金额/有零售数据的门店数量"},{name:"当日店均销量",description:"查询日期所有门店零售数量/有零售数据的门店数量"},{name:"当日店均单价",description:"所有门店零售金额/所有门店零售数量"},{name:"当月累计单店",description:"当月所有门店零售金额/有零售数据的门店数量/天数"},{name:"增长",description:"(当月累计单店-上年当月累计单店)/上年当月累计单店"},{name:"老店",description:"开店时间大于365天的店铺"},{name:"老店年日均",description:"当月所有门店零售金额/门店数量/天数"},{name:"老店日均增长",description:"(当月累计单店-上年当月累计单店)/上年当月累计单店"},{name:"老店年当日店均",description:"当日所有门店零售金额/门店数量"},{name:"日均增长",description:"(当日累计单店-上年当日累计单店)/上年当日累计单店"}],retailShare:[{name:"所属经销商",description:"按客户区分"},{name:"销量占比",description:"当日所有门店年份+季节款   零售总数量/当日所有零售数量"},{name:"均单价",description:"当日所有门店年份+季节款   零售总金额/当日年份+季节款零售总数量"},{name:"库存占比",description:"当日所有门店年份+季节款   库存/当日所有库存"},{name:"单店铺货量",description:"当日所有门店年份+季节款   库存/门店数量"}]}}},computed:{tipsData:function(){return"top30"===this.title?this.tips.top30:"系统客户日均单店"===this.title?this.tips.storeDayAvg:"零售占比"===this.title?this.tips.retailShare:"字段提示，提示板块开发中....."}},methods:{handleDownload:function(e){this.$emit("handleDownload",e)},tipsInfo:function(e){this.dialogVisible=!this.dialogVisible},handleFilter:function(){var e=Object.assign({},this.listQuery);this.$emit("getAnalysis",e)},exportPdf:function(){this.$emit("exportPdf")},querySearch:function(e,t){var a=this.restaurants,l=e?a.filter(this.createFilter(e)):a;t(l)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleClose:function(e){this.dialogVisible=!this.dialogVisible}}},c=s,d=(a("d991"),a("2877")),u=Object(d["a"])(c,l,n,!1,null,"0653bd05",null);t["a"]=u.exports},ad8f:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c}));var l=a("b775"),n="";function i(e){return Object(l["a"])({url:n+"/Q/r.do?o=qgrxTOP30",method:"get",params:e})}function r(e){return Object(l["a"])({url:n+"/Q/r.do?o=xtkhrjdd",method:"get",params:e})}function o(e){return Object(l["a"])({url:n+"/Q/r.do?o=djlszb",method:"get",params:e})}function s(e){return Object(l["a"])({url:n+"/Q/r.do?o=xsfxJxc",method:"get",params:e})}function c(e){return Object(l["a"])({url:n+"/Q/r.do?o=bmjg",method:"get",params:e})}},bcfe:function(e,t,a){"use strict";var l=a("6cec"),n=a.n(l);n.a},d991:function(e,t,a){"use strict";var l=a("f9e1"),n=a.n(l);n.a},e251:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,title:e.title,width:"50%","before-close":e.handleClose,"custom-class":"dialog-class"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{attrs:{data:e.tipsData}},[a("el-table-column",{attrs:{property:"name",label:"字段名",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{property:"description",label:"字段说明"}})],1)],1)},n=[],i={props:{dialogVisible:{type:Boolean,default:!1},tipsData:{type:Array,default:function(){return[]}},title:{type:String,default:""}},data:function(){return{}},watch:{title:function(e){console.log(e)}},methods:{handleClose:function(e){this.$emit("handleClose",!1)}}},r=i,o=(a("056e"),a("5336"),a("2877")),s=Object(o["a"])(r,l,n,!1,null,"4e0d5540",null);t["a"]=s.exports},f8f1:function(e,t,a){},f9e1:function(e,t,a){}}]);