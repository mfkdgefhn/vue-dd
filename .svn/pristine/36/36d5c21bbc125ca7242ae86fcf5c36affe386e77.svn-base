(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65881e74"],{"0bb0":function(e,t,a){"use strict";var l=a("2b1a"),n=a.n(l);n.a},"2b1a":function(e,t,a){},"35ee":function(e,t,a){},"4c8e":function(e,t,a){},"76ff":function(e,t,a){"use strict";var l=a("4c8e"),n=a.n(l);n.a},"7ef0":function(e,t,a){},8033:function(e,t,a){"use strict";var l=a("35ee"),n=a.n(l);n.a},"8d41":function(e,t,a){},9130:function(e,t,a){"use strict";var l=a("7ef0"),n=a.n(l);n.a},e169:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"vip"},[a("el-card",{staticClass:"crad",attrs:{shadow:"hover"}},[a("search-vip",{attrs:{loading:e.loading},on:{getAnalysis:e.getAnalysis,handleDownload:e.handleDownload,exportPdf:e.exportPdf}})],1),e._v(" "),e.page?a("el-card",{attrs:{"body-style":{padding:"0px 0px 50px 0px"}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.table.tableData,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",border:""},on:{"row-click":e.showVipInfo}},[a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customer",label:"经销商",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"store",label:"开卡店仓",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"card",label:"会员卡号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vipType",label:"会员卡类别",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mobel",label:"手机号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"integral",label:"剩余积分",align:"center"}})],1)],1):e._e(),e._v(" "),e.page?a("el-card",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.table.currentPage,"page-sizes":e.table.pageSizes,"page-size":e.table.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.table.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e(),e._v(" "),a("prompt-box-new",{attrs:{loading:e.loading,"dialog-visible":e.dialogVisible,title:e.table.title,"tips-data":e.tipsData},on:{handleClose:e.handleClose}})],1)},n=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"seach-length"},[a("el-row",{attrs:{gutter:10}},[a("el-col",[a("el-date-picker",{staticClass:"price-class",attrs:{type:"date","value-format":"yyyyMMdd",placeholder:"开始日期",format:"yyyyMMdd"},model:{value:e.listQuery.beginDate,callback:function(t){e.$set(e.listQuery,"beginDate",t)},expression:"listQuery.beginDate"}}),e._v(" "),a("span",{staticStyle:{"line-height":"38px",color:"#ccc"}},[e._v("至")]),e._v(" "),a("el-date-picker",{staticClass:"price-class",attrs:{type:"date","value-format":"yyyyMMdd",placeholder:"结束日期",format:"yyyyMMdd"},model:{value:e.listQuery.endDate,callback:function(t){e.$set(e.listQuery,"endDate",t)},expression:"listQuery.endDate"}}),e._v(" "),a("el-input",{staticClass:"price-class",attrs:{type:"tel",onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'');",maxlength:"4",placeholder:"低价"},model:{value:e.listQuery.minPrice,callback:function(t){e.$set(e.listQuery,"minPrice",t)},expression:"listQuery.minPrice"}}),e._v(" "),a("span",{staticStyle:{"line-height":"38px",color:"#ccc"}},[e._v("至")]),e._v(" "),a("el-input",{staticClass:"price-class",attrs:{onkeyup:"this.value=this.value.replace(/[^\\d.]/g,'');",maxlength:"4",type:"tel",placeholder:"高价"},model:{value:e.listQuery.maxPrice,callback:function(t){e.$set(e.listQuery,"maxPrice",t)},expression:"listQuery.maxPrice"}}),e._v(" "),a("el-select",{staticClass:"price-class",staticStyle:{"margin-left":"20px"},attrs:{multiple:"",clearable:"","collapse-tags":"",placeholder:"经销商"},model:{value:e.listQuery.customer,callback:function(t){e.$set(e.listQuery,"customer",t)},expression:"listQuery.customer"}},e._l(e.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),e._v(" "),a("el-select",{staticClass:"price-class",staticStyle:{"margin-left":"20px"},attrs:{multiple:"",clearable:"","collapse-tags":"",placeholder:"风格"},model:{value:e.listQuery.mid8,callback:function(t){e.$set(e.listQuery,"mid8",t)},expression:"listQuery.mid8"}},e._l(e.mid8s,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search",loading:e.loading,disabled:e.loading},on:{click:e.handleFilter}},[e._v("会员挖掘")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload("this")}}},[e._v("单页导出")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload("all")}}},[e._v("全部导出")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:e.exportPdf}},[e._v("PDF")])],1)],1)],1)},s=[];a("ac6a"),a("c1df");function r(e,t){e=void 0===e?0:e,t=void 0===t?"":t;var a=new Date;a.setDate(a.getDate()+e);var l=a.getFullYear(),n=a.getMonth()+1,i=a.getDate();return n=n>9?n:"0"+n,i=i>9?i:"0"+i,""===t?""+l+n+i:"Y"===t?""+l:"M"===t?""+n:"D"===t?""+i:"YM"===t?""+l+n:"MD"===t?""+n+i:"YMD"===t?""+l+n+i:""}a("8d41");var o="@@wavesContext";function c(e,t){function a(a){var l=Object.assign({},t.value),n=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},l),i=n.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var s=i.getBoundingClientRect(),r=i.querySelector(".waves-ripple");switch(r?r.className="waves-ripple":(r=document.createElement("span"),r.className="waves-ripple",r.style.height=r.style.width=Math.max(s.width,s.height)+"px",i.appendChild(r)),n.type){case"center":r.style.top=s.height/2-r.offsetHeight/2+"px",r.style.left=s.width/2-r.offsetWidth/2+"px";break;default:r.style.top=(a.pageY-s.top-r.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",r.style.left=(a.pageX-s.left-r.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return r.style.backgroundColor=n.color,r.className="waves-ripple z-active",!1}}return e[o]?e[o].removeHandle=a:e[o]={removeHandle:a},a}var d={bind:function(e,t){e.addEventListener("click",c(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[o].removeHandle,!1),e.addEventListener("click",c(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[o].removeHandle,!1),e[o]=null,delete e[o]}},u=function(e){e.directive("waves",d)};window.Vue&&(window.waves=d,Vue.use(u)),d.install=u;var p=d,h=(a("a481"),a("7618"));function g(e){switch(Object(h["a"])(e)){case"undefined":return!0;case"string":if(0===e.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,"").length)return!0;break;case"boolean":if(!e)return!0;break;case"number":if(0===e||isNaN(e))return!0;break;case"object":if(null===e||0===e.length)return!0;for(var t in e)return!1;return!0}return!1}var m={name:"SearchVip",props:{loading:{type:Boolean,default:!1}},data:function(){return{listQuery:{beginDate:r(-7),endDate:r(-1),loading:!1},options:[],mid8s:[]}},directives:{waves:p},computed:{},watch:{},created:function(){this.init()},mounted:function(){},methods:{init:function(){var e=this;this.$store.dispatch("baseApi/getCustomer").then((function(){e.options=e.$store.getters.customer})),this.$store.dispatch("baseApi/getProductStyle").then((function(){e.mid8s=e.$store.getters.productStyle}))},handleFilter:function(){if(this.judge(this.listQuery))this.$message.error("最小值超过最大值，请重新输入！");else if(g(this.listQuery.customer.length)&&g(this.listQuery.minPrice)&&g(this.listQuery.maxPrice))this.$message.error("查询数据过万，请输入查询参数！！！");else{var e=Object.assign({},this.listQuery);this.handle(e),this.$emit("getAnalysis",e)}},judge:function(e){return!!e.minPrice&&(!!e.maxPrice&&e.minPrice>e.maxPrice)},handle:function(e){if(e.beginDate||e.endDate&&(e.jzDate=e.endDate,e.endDate=null),e.endDate||e.beginDate&&(e.qsDate=e.beginDate,e.beginDate=null),e.beginDate||e.endDate||(e.beginDate=20180101,e.endDate=r(-1)),e.customer.length>0){var t=[];e.customer.forEach((function(e){t.push(e)})),e.customer=t.join(",")}else delete e.customer;if(e.mid8.length>0){t=[];e.mid8.forEach((function(e){t.push(e)})),e.mid8=t.join(",")}else delete e.mid8},handleDownload:function(e){this.$emit("handleDownload",e)},exportPdf:function(){this.$emit("exportPdf")}}},b=m,f=(a("9130"),a("2877")),v=Object(f["a"])(b,i,s,!1,null,"dd6b6a76",null),y=v.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,width:"80%","before-close":e.handleClose,"custom-class":"dialog-class",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.title)},slot:"title"}),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tipsData}},[a("el-table-column",{attrs:{property:"billdate",label:"单据日期"}}),e._v(" "),a("el-table-column",{attrs:{property:"cStoreName",label:"店仓"}}),e._v(" "),a("el-table-column",{attrs:{property:"docno",label:"单据编号"}}),e._v(" "),a("el-table-column",{attrs:{property:"mProductName",label:"款号"}}),e._v(" "),a("el-table-column",{attrs:{property:"totAmtActual",label:"价格"}}),e._v(" "),a("el-table-column",{attrs:{property:"attribname",label:"风格"}})],1)],1)},x=[],D={props:{dialogVisible:{type:Boolean,default:!1},tipsData:{type:Array,default:function(){return[]}},title:{type:String,default:""},loading:{type:Boolean,default:!1}},data:function(){return{}},watch:{},methods:{handleClose:function(e){this.$emit("handleClose",!1)}}},_=D,k=(a("76ff"),a("0bb0"),Object(f["a"])(_,w,x,!1,null,"cdf97514",null)),C=k.exports;function P(e,t,a){var l=(e-1)*t;return l+t>=a.length?a.slice(l,a.length):a.slice(l,l+t)}var $=a("ed08"),S={name:"Vip",components:{searchVip:y,promptBoxNew:C},data:function(){return{loading:!1,dialogVisible:!1,page:!1,title:"会员挖掘",tipsData:[],tableData:[],table:{total:0,title:"",currentPage:1,pageSize:10,pageSizes:[10,20,30,40],tableData:[]}}},created:function(){},methods:{init:function(){},getAnalysis:function(e){var t=this;this.loading=!0,this.table.tableData=[],this.$store.dispatch("baseApi/getVipExcavate",e).then((function(){t.table.currentPage=1,t.table.pageSize=10,t.page=!0,t.table.total=t.$store.getters.vipExcavate.length,t.table.tableData=P(1,t.table.pageSize,t.$store.getters.vipExcavate),t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},handleSizeChange:function(e){this.table.pageSize=e,this.table.tableData=P(this.table.currentPage,this.table.pageSize,this.$store.getters.vipExcavate)},handleCurrentChange:function(e){this.table.currentPage=e,this.table.tableData=P(this.table.currentPage,this.table.pageSize,this.$store.getters.vipExcavate)},showVipInfo:function(e){var t=this;this.loading=!0,this.$store.dispatch("baseApi/getVipRetail",e).then((function(){t.dialogVisible=!t.dialogVisible,t.tipsData=t.$store.getters.vipRetail,t.table.title=t.jsonToString(e),t.loading=!1})).catch((function(e){t.loading=!1,console.log(e)}))},jsonToString:function(e){var t="";return t='<span class="html-title">经销商：</span><span class="html-font">'+e.customer+'</span><span class="html-title">所属店仓：</span><span class="html-font">'+e.store+'</span><span class="html-title">手机：</span><span class="html-font">'+e.mobel+'</span><br><span class="html-title">卡号：</span><span class="html-font">'+e.card+'</span><span class="html-title">昵称：</span><span class="html-font">'+e.nickName+'</span><span class="html-title">剩余积分：</span><span class="html-font">'+e.integral+"</span>",t},handleClose:function(e){this.dialogVisible=!this.dialogVisible},exportPdf:function(){this.getPdf("会员挖掘")},handleDownload:function(e){var t=this;this.loading=!0,0!==this.table.tableData.length?(e=void 0===e?"":e,Promise.all([a.e("chunk-014a57fc"),a.e("chunk-58293907")]).then(a.bind(null,"4bf8d")).then((function(a){var l=["经销商","开卡店仓","会员卡号","会员卡类别","手机号","剩余积分"],n=["customer","store","card","vipType","mobel","integral"],i=t.formatJson(n,e);a.export_json_to_excel({header:l,data:i,filename:t.title+t.$moment().format("YYYY-MM-DD")}),t.loading=!1}))):this.loading=!1},formatJson:function(e,t){var a=[];if("all"===t)a=this.$store.getters.vipExcavate;else{if("this"!==t)return;a=this.table.tableData}return a.map((function(t){return e.map((function(e){return"timestamp"===e?Object($["b"])(t[e]):t[e]}))}))}}},Q=S,j=(a("8033"),Object(f["a"])(Q,l,n,!1,null,null,null));t["default"]=j.exports}}]);