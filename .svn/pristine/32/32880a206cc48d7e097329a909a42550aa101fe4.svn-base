(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6eccd86a"],{"0b6f":function(e,t,a){},"3aa2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"RetailShare"},[a("el-card",{staticClass:"crad",attrs:{shadow:"hover"}},[a("search-sale",{attrs:{title:e.table.title,loading:e.loading},on:{getAnalysis:e.getAnalysis,handleDownload:e.handleDownload,exportPdf:e.exportPdf}})],1),e._v(" "),e.page?a("el-card",{attrs:{"body-style":{padding:"0px 0px 50px 0px"}}},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.tabClick}},e._l(e.table,(function(t){return a("el-tab-pane",{key:t.index,attrs:{label:t.title}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"pdfDom","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",data:t.tableData,"row-style":e.rowStyle,"header-cell-style":{padding:"0px 0px"}}},[a("el-table-column",{attrs:{label:t.title,align:"center"}},[a("el-table-column",{attrs:{prop:"area",label:"区域",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"customer",label:"所属经销商",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:t.year+t.seasonCh,align:"center"}},[a("el-table-column",{attrs:{prop:"newSalesShare",label:"销售占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newAvgPrice",label:"均单价",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newInventoryRatio",label:"库存占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"newStoreVolume",label:"单店铺货量",align:"center"}})],1)],1),e._v(" "),a("el-table-column",{attrs:{label:e.date,align:"center"}},[a("el-table-column",{attrs:{label:t.year-1+t.seasonCh,align:"center"}},[a("el-table-column",{attrs:{prop:"oldSalesShare",label:"销售占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldAvgPrice",label:"单价",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldInventoryRatio",label:"库存占比",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"oldStoreVolume",label:"单店铺货量",align:"center"}})],1)],1)],1)],1)})),1)],1):e._e()],1)},i=[],l=(a("ac6a"),a("a745")),r=a.n(l);function o(e){if(r()(e))return e}var s=a("5d73"),c=a.n(s),d=a("c8bb"),u=a.n(d);function b(e,t){if(u()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],n=!0,i=!1,l=void 0;try{for(var r,o=c()(e);!(n=(r=o.next()).done);n=!0)if(a.push(r.value),t&&a.length===t)break}catch(s){i=!0,l=s}finally{try{n||null==o["return"]||o["return"]()}finally{if(i)throw l}}return a}}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(e,t){return o(e)||b(e,t)||h()}a("96cf");var m=a("3b8d"),f=a("ab95"),v=a("ad8f"),g=a("ed08"),y=a("6f9c"),w={name:"RetailShare",components:{searchSale:f["a"]},data:function(){return{loading:!1,date:"",page:!1,total:0,table:[],tabIndex:0}},methods:{tabClick:function(e){this.tabIndex=e.index},getAnalysis:function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(t){var a,n,i,l,r,o,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.table=[],this.loading=!0,this.date="查询时间："+t.billdate,a=this.$moment(t.billdate).month()+1,n=3===a||6===a||9===a||12===a?["+3","0","-3"]:["0","-3","-6"],i=p(n,3),l=i[0],r=i[1],o=i[2],this.table.push({billdate:t.billdate,year:this.$moment(t.billdate).add(l,"M").year(),seasonCh:Object(y["b"])(this.$moment(t.billdate).add(l,"M")).ch,season:Object(y["b"])(this.$moment(t.billdate).add(l,"M")).zh,title:""+this.$moment(t.billdate).add(l,"M").year()+Object(y["b"])(this.$moment(t.billdate).add(l,"M")).ch+"数量占比"}),e.next=8,Object(v["c"])(this.table[0]).then((function(e){s.$store.dispatch("table/setRetailShare",e),s.table[0].tableData=e}));case 8:return this.table.push({billdate:t.billdate,year:this.$moment(t.billdate).add(r,"M").year(),seasonCh:Object(y["b"])(this.$moment(t.billdate).add(r,"M")).ch,season:Object(y["b"])(this.$moment(t.billdate).add(r,"M")).zh,title:""+this.$moment(t.billdate).add(r,"M").year()+Object(y["b"])(this.$moment(t.billdate).add(r,"M")).ch+"数量占比"}),e.next=11,Object(v["c"])(this.table[1]).then((function(e){s.$store.dispatch("table/setLastRetailShare",e),s.table[1].tableData=e}));case 11:return this.table.push({billdate:t.billdate,year:this.$moment(t.billdate).add(o,"M").year(),seasonCh:Object(y["b"])(this.$moment(t.billdate).add(o,"M")).ch,season:Object(y["b"])(this.$moment(t.billdate).add(o,"M")).zh,title:""+this.$moment(t.billdate).add(o,"M").year()+Object(y["b"])(this.$moment(t.billdate).add(o,"M")).ch+"数量占比"}),e.next=14,Object(v["c"])(this.table[2]).then((function(e){s.$store.dispatch("table/setLastMaxRetailShare",e),s.table[2].tableData=e,s.page=!0,s.loading=!1}));case 14:this.$message({message:"查询完成!!!",type:"success"});case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),exportPdf:function(){this.getPdf(this.table[this.tabIndex].title)},handleDownload:function(e){var t=this;this.loading=!0,0!==this.table[this.tabIndex].tableData.length?(e=void 0===e?"":e,Promise.all([a.e("chunk-014a57fc"),a.e("chunk-581b2547")]).then(a.bind(null,"4bf8d")).then((function(a){var n=["区域","所属经销商","销售占比","均单价","库存占比","单店铺货量","销售占比","单价","库存占比","单店铺货量"],i=["area","customer","newSalesShare","newAvgPrice","newInventoryRatio","newStoreVolume","oldSalesShare","oldAvgPrice","oldInventoryRatio","oldStoreVolume"],l=t.formatJson(i,e);if("this"===e)a.export_json_to_excel({header:n,data:l,filename:t.table[t.tabIndex].title});else if("all"===e){var r=[];t.table.forEach((function(e){r.push({tHeader:n,filterVal:i,tableDatas:e.tableData,sheetName:e.title})})),t.json2excel(r,"零售占比",!0,"xlsx")}t.loading=!1}))):this.loading=!1},formatJson:function(e,t){var a=[];if("all"===t)a=this.$store.getters.retailShare;else{if("this"!==t)return;a=this.table[this.tabIndex].tableData}return a.map((function(t){return e.map((function(e){return"timestamp"===e?Object(g["b"])(t[e]):t[e]}))}))},json2excel:function(e,t,n,i){var l=this;Promise.all([a.e("chunk-014a57fc"),a.e("chunk-581b2547")]).then(a.bind(null,"4bf8d")).then((function(a){var r=[],o=[],s=[];for(var c in e)r.push(e[c].tHeader),o.push(l.formatJson1(e[c].filterVal,e[c].tableDatas)),s.push(e[c].sheetName);a.export_json_to_excel_sheetname({header:r,data:o,sheetname:s,filename:t,autoWidth:n,bookType:i})}))},formatJson1:function(e,t){return t.map((function(t){return e.map((function(e){return"timestamp"===e?Object(g["b"])(t[e]):t[e]}))}))},rowStyle:function(e){var t=e.row;e.rowIndex;return"区域汇总"===t.customer?"background: #DDE6ED":""}}},x=w,k=(a("436a"),a("aac1"),a("2877")),j=Object(k["a"])(x,n,i,!1,null,"3d685d66",null);t["default"]=j.exports},"436a":function(e,t,a){"use strict";var n=a("a7863"),i=a.n(n);i.a},"469f":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("7d7b")},"4e68":function(e,t,a){},5336:function(e,t,a){"use strict";var n=a("93dd"),i=a.n(n);i.a},"5d73":function(e,t,a){e.exports=a("469f")},6724:function(e,t,a){"use strict";a("8d41");var n="@@wavesContext";function i(e,t){function a(a){var n=Object.assign({},t.value),i=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),l=i.ele;if(l){l.style.position="relative",l.style.overflow="hidden";var r=l.getBoundingClientRect(),o=l.querySelector(".waves-ripple");switch(o?o.className="waves-ripple":(o=document.createElement("span"),o.className="waves-ripple",o.style.height=o.style.width=Math.max(r.width,r.height)+"px",l.appendChild(o)),i.type){case"center":o.style.top=r.height/2-o.offsetHeight/2+"px",o.style.left=r.width/2-o.offsetWidth/2+"px";break;default:o.style.top=(a.pageY-r.top-o.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",o.style.left=(a.pageX-r.left-o.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return o.style.backgroundColor=i.color,o.className="waves-ripple z-active",!1}}return e[n]?e[n].removeHandle=a:e[n]={removeHandle:a},a}var l={bind:function(e,t){e.addEventListener("click",i(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[n].removeHandle,!1),e.addEventListener("click",i(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[n].removeHandle,!1),e[n]=null,delete e[n]}},r=function(e){e.directive("waves",l)};window.Vue&&(window.waves=l,Vue.use(r)),l.install=r;t["a"]=l},"6f9c":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}));var n=a("c1df");function i(e,t){e=void 0===e?0:e,t=void 0===t?"":t;var a=new Date;a.setDate(a.getDate()+e);var n=a.getFullYear(),i=a.getMonth()+1,l=a.getDate();return i=i>9?i:"0"+i,l=l>9?l:"0"+l,""===t?""+n+i+l:"Y"===t?""+n:"M"===t?""+i:"D"===t?""+l:"YM"===t?""+n+i:"MD"===t?""+i+l:"YMD"===t?""+n+i+l:""}function l(e){var t=void 0===e?n().month()+1:n(e).month()+1,a={};switch(t){case 1:case 2:case 3:a={ch:"春季",zh:"37"};break;case 4:case 5:case 6:a={ch:"夏季",zh:"38"};break;case 7:case 8:case 9:a={ch:"秋季",zh:"39"};break;case 10:case 11:case 12:a={ch:"冬季",zh:"40"};break;default:a="";break}return a}},"7d7b":function(e,t,a){var n=a("e4ae"),i=a("7cd6");e.exports=a("584a").getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},"8d41":function(e,t,a){},9292:function(e,t,a){},"93dd":function(e,t,a){},a7863:function(e,t,a){},aac1:function(e,t,a){"use strict";var n=a("4e68"),i=a.n(n);i.a},ab95:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"seach-length"},[a("el-row",{attrs:{gutter:10}},[a("el-col",[a("el-date-picker",{staticStyle:{"min-width":"300px","margin-bottom":"5px","font-size":"12px"},attrs:{type:"date","value-format":"yyyyMMdd",placeholder:"开始日期","picker-options":e.pickerOptions,format:"yyyyMMdd"},model:{value:e.listQuery.billdate,callback:function(t){e.$set(e.listQuery,"billdate",t)},expression:"listQuery.billdate"}}),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search",loading:e.loading,disabled:e.loading},on:{click:e.handleFilter}},[e._v("查询")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload("this")}}},[e._v("单页导出")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.handleDownload("all")}}},[e._v("全部导出")]),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.loading,type:"primary",icon:"el-icon-download"},on:{click:e.exportPdf}},[e._v("PDF")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-message",circle:""},on:{click:e.tipsInfo}})],1)],1),e._v(" "),a("prompt-box",{attrs:{"dialog-visible":e.dialogVisible,title:e.title,"tips-data":e.tipsData},on:{handleClose:e.handleClose}})],1)},i=[],l=a("6724"),r=a("6f9c"),o=a("e251"),s={name:"SearchSale",directives:{waves:l["a"]},components:{promptBox:o["a"]},props:{loading:{type:Boolean,default:!1},title:{type:String,default:""}},data:function(){return{showAllLevels:!1,listQuery:{billdate:Object(r["a"])(-1)},storeOptions:[],restaurants:[],dialogVisible:!1,options:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()-864e5}},tips:{top30:[{name:"店铺名称",description:"有零售数据的店铺"},{name:"日业绩",description:"查询日期的零售金额"},{name:"日销量",description:"查询日期的零售数量"},{name:"日单价",description:"日业绩/日销量,取整"},{name:"本月业绩",description:"查询日期月份的总零售金额"},{name:"本月销量",description:"查询日期月份的总零售数量"},{name:"本月日均销额",description:"本月业绩/本月销量天数"},{name:"季度库存",description:"查询当日的款号季度库存，12月能查春季库存、3月能查夏季库存、6月能查秋季库存、9月能查冬季库存"}],storeDayAvg:[{name:"经销商",description:"按客户区分"},{name:"当日店均销额",description:"查询日期所有门店零售金额/有零售数据的门店数量"},{name:"当日店均销量",description:"查询日期所有门店零售数量/有零售数据的门店数量"},{name:"当日店均单价",description:"所有门店零售金额/所有门店零售数量"},{name:"当月累计单店",description:"当月所有门店零售金额/有零售数据的门店数量/天数"},{name:"增长",description:"(当月累计单店-上年当月累计单店)/上年当月累计单店"},{name:"老店",description:"开店时间大于365天的店铺"},{name:"老店年日均",description:"当月所有门店零售金额/门店数量/天数"},{name:"老店日均增长",description:"(当月累计单店-上年当月累计单店)/上年当月累计单店"},{name:"老店年当日店均",description:"当日所有门店零售金额/门店数量"},{name:"日均增长",description:"(当日累计单店-上年当日累计单店)/上年当日累计单店"}],retailShare:[{name:"所属经销商",description:"按客户区分"},{name:"销量占比",description:"当日所有门店年份+季节款   零售总数量/当日所有零售数量"},{name:"均单价",description:"当日所有门店年份+季节款   零售总金额/当日年份+季节款零售总数量"},{name:"库存占比",description:"当日所有门店年份+季节款   库存/当日所有库存"},{name:"单店铺货量",description:"当日所有门店年份+季节款   库存/门店数量"}]}}},computed:{tipsData:function(){return"top30"===this.title?this.tips.top30:"系统客户日均单店"===this.title?this.tips.storeDayAvg:"零售占比"===this.title?this.tips.retailShare:["字段提示，提示板块开发中....."]}},methods:{handleDownload:function(e){this.$emit("handleDownload",e)},tipsInfo:function(e){this.dialogVisible=!this.dialogVisible},handleFilter:function(){var e=Object.assign({},this.listQuery);this.$emit("getAnalysis",e)},exportPdf:function(){this.$emit("exportPdf")},querySearch:function(e,t){var a=this.restaurants,n=e?a.filter(this.createFilter(e)):a;t(n)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleClose:function(e){this.dialogVisible=!this.dialogVisible}}},c=s,d=(a("eef9"),a("2877")),u=Object(d["a"])(c,n,i,!1,null,"17cade55",null);t["a"]=u.exports},ad8f:function(e,t,a){"use strict";a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c}));var n=a("b775"),i="";function l(e){return Object(n["a"])({url:i+"/Q/r.do?o=qgrxTOP30",method:"get",params:e})}function r(e){return Object(n["a"])({url:i+"/Q/r.do?o=xtkhrjdd",method:"get",params:e})}function o(e){return Object(n["a"])({url:i+"/Q/r.do?o=djlszb",method:"get",params:e})}function s(e){return Object(n["a"])({url:i+"/Q/r.do?o=xsfxJxc",method:"get",params:e})}function c(e){return Object(n["a"])({url:i+"/Q/r.do?o=bmjg",method:"get",params:e})}},e251:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,title:e.title,width:"50%","before-close":e.handleClose,"custom-class":"dialog-class"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{attrs:{data:e.tipsData}},[a("el-table-column",{attrs:{property:"name",label:"字段名",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{property:"description",label:"字段说明"}})],1)],1)},i=[],l={props:{dialogVisible:{type:Boolean,default:!1},tipsData:{type:Array,default:function(){return[]}},title:{type:String,default:""}},data:function(){return{}},watch:{},methods:{handleClose:function(e){this.$emit("handleClose",!1)}}},r=l,o=(a("f39b"),a("5336"),a("2877")),s=Object(o["a"])(r,n,i,!1,null,"51e89278",null);t["a"]=s.exports},eef9:function(e,t,a){"use strict";var n=a("9292"),i=a.n(n);i.a},f39b:function(e,t,a){"use strict";var n=a("0b6f"),i=a.n(n);i.a}}]);